<!DOCTYPE html>
<html lang="sk">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Zahraj si s nami kvízovú hru!</title>
	<link rel="stylesheet" href="/shared/common.css">
	<style>
		* {
			margin: 0;
			padding: 0;
			min-width: 0;
			box-sizing: border-box;
		}

		html,
		body {
			height: 100vh;
			width: 100%;
			display: flex;
			justify-content: center;
			background: linear-gradient(135deg, #47109e 0%, #5a1ba8 50%, #3e0d85 100%);
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			overflow: hidden;
			position: relative;
		}

		/* Animated background effect */
		body::before {
			content: '';
			position: fixed;
			top: -50%;
			left: -50%;
			width: 200%;
			height: 200%;
			background: radial-gradient(circle, transparent 20%, rgba(255, 255, 255, 0.02) 40%, transparent 70%);
			animation: rotate 60s linear infinite;
			pointer-events: none;
			z-index: 0;
		}

		@keyframes rotate {
			from { transform: rotate(0deg); }
			to { transform: rotate(360deg); }
		}

		.badge {
			border-radius: 1.5em;
			padding: 0.5em 1em;
			color: white;
			background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
			backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.3);
			font-weight: bold;
			white-space: nowrap;
			flex-shrink: 0;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
			animation: badgeFloat 3s ease-in-out infinite;
			font-size: 0.9em;
		}

		@keyframes badgeFloat {
			0%, 100% { transform: translateY(0px); }
			50% { transform: translateY(-1px); }
		}

		.page,
		.content-wrapper {
			display: none;
			text-align: center;
			flex: 1;
		}

		.page.visible,
		.content-wrapper.visible {
			display: flex;
		}

		.vertical_center,
		.vertical_space {
			display: flex;
			flex-direction: column;
			justify-content: center;
			height: 100vh;
			width: 100%;
			max-height: 100vh;
		}

		.vertical_space {
			justify-content: space-between;
		}

		.logo {
			font-size: 2rem;
			font-weight: bold;
			color: white;
			text-wrap: balance;
			margin-bottom: 2rem;
		}

		.pin-box {
			padding: 30px 40px;
			background: white;
			border-radius: 8px;
			box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
			display: flex;
			flex-direction: column;
			align-items: center;
			margin: 2em;
		}

		input {
			font-size: 1.2em;
			padding: 1em 1.5em;
			width: 100%;
			margin-bottom: 15px;
			border: 1px solid #ccc;
			border-radius: 4px;
			text-align: center;
		}

		button {
			font-size: 1.2rem;
			padding: 10px;
			width: 100%;
			border: none;
			background-color: #007BFF;
			color: white;
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s;
		}

		button:hover:not(:disabled) {
			background-color: #0056b3;
		}

		button:disabled {
			background-color: #ccc;
			cursor: not-allowed;
		}

		#header {
			padding: 1em 1.5em;
			color: white;
			display: flex;
			justify-content: space-between;
			align-items: center;
			position: relative;
			z-index: 2;
			animation: headerSlideDown 0.8s ease-out;
			flex-shrink: 0;
		}

		@keyframes headerSlideDown {
			from {
				transform: translateY(-50px);
				opacity: 0;
			}
			to {
				transform: translateY(0);
				opacity: 1;
			}
		}

		.header-right {
			display: flex;
			align-items: center;
			gap: 0.75rem;
		}

		.leave-btn {
			background-color: #dc3545;
			border: none;
			color: white;
			padding: 0.4rem 0.8rem;
			border-radius: 0.4rem;
			cursor: pointer;
			font-size: 0.8rem;
			font-weight: bold;
			transition: background-color 0.2s;
		}

		.leave-btn:hover {
			background-color: #c82333;
		}

		.content-wrapper {
			flex: 1;
			font-size: 1.5em;
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(10px);
			border-radius: 1.5em 1.5em 0 0;
			color: black;
			flex-direction: column;
			justify-content: space-between;
			box-shadow: 0 -8px 30px rgba(0, 0, 0, 0.2);
			position: relative;
			z-index: 1;
			animation: slideUpContent 0.6s ease-out;
			min-height: 0;
			overflow: hidden;
		}

		@keyframes slideUpContent {
			from {
				transform: translateY(50px);
				opacity: 0;
			}
			to {
				transform: translateY(0);
				opacity: 1;
			}
		}

		.question {
			padding: 1em;
			font-size: 1.7em;
			font-weight: bold;
			background: linear-gradient(135deg, rgba(71, 16, 158, 0.1), rgba(255, 255, 255, 0.1));
			border-radius: 1em;
			margin: 0;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			animation: questionAppear 0.8s ease-out;
			position: relative;
			flex: 0 0 40%;
			display: flex;
			align-items: center;
			justify-content: center;
			text-align: center;
		}


		@keyframes questionAppear {
			from {
				transform: translateY(-20px) scale(0.95);
				opacity: 0;
			}
			to {
				transform: translateY(0) scale(1);
				opacity: 1;
			}
		}

		#playground .options_container {
			flex: 0 0 60%;
			display: flex;
			position: relative;
			min-height: 0;
		}

		#playground .options_container #timer {
			z-index: 50;
			flex: 1;
			position: absolute;
			left: 50%;
			top: 50%;
			transform: translate(-50%, -50%);
			background: linear-gradient(135deg, #ffffff, #f8f9fa);
			font-weight: bold;
			aspect-ratio: 1;
			display: flex;
			justify-content: center;
			align-items: center;
			width: 3em;
			overflow: hidden;
			border-radius: 100%;
			box-shadow: 0 8px 25px rgba(0,0,0,0.3), 0 0 40px rgba(71, 16, 158, 0.2);
			font-size: 1.3em;
			border: 3px solid rgba(71, 16, 158, 0.2);
			animation: timerPulse 2s ease-in-out infinite;
		}

		@keyframes timerPulse {
			0%, 100% {
				transform: translate(-50%, -50%) scale(1);
				box-shadow: 0 8px 25px rgba(0,0,0,0.3), 0 0 40px rgba(71, 16, 158, 0.2);
			}
			50% {
				transform: translate(-50%, -50%) scale(1.02);
				box-shadow: 0 10px 30px rgba(0,0,0,0.35), 0 0 45px rgba(71, 16, 158, 0.3);
			}
		}

		/* Timer states - show/hide content based on waiting class */
		#timer .timer-text {
			display: block;
		}

		#timer .spinner {
			display: none;
			/* Override spinner colors for better contrast on white background */
			width: 1em;
			height: 1em;
			border: 2px solid #ddd;
			border-top-color: var(--primary-purple);
		}

		#timer.waiting .timer-text {
			display: none;
		}

		#timer.waiting .spinner {
			display: block;
		}

		#playground #options {
			flex: 1;
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			grid-template-rows: repeat(2, 1fr);
			gap: 0.1em;
		}

		#playground #options .option {
			display: flex;
			align-items: center;
			flex-direction: column;
			padding: 0.6em;
			overflow: hidden;
			justify-content: center;
			color: white;
			cursor: pointer;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			border-radius: 1em;
			margin: 0.05em;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
			position: relative;
			animation: optionSlideIn 0.6s ease-out forwards;
			opacity: 0;
			transform: translateY(30px);
			gap: 0.3em;
		}

		#playground #options .option:nth-child(1) { animation-delay: 0.1s; }
		#playground #options .option:nth-child(2) { animation-delay: 0.2s; }
		#playground #options .option:nth-child(3) { animation-delay: 0.3s; }
		#playground #options .option:nth-child(4) { animation-delay: 0.4s; }

		@keyframes optionSlideIn {
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		.option:hover:not([style*="pointer-events: none"]) {
			transform: translateY(-8px) scale(1.02);
			box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
		}

		.option:active:not([style*="pointer-events: none"]) {
			transform: translateY(-4px) scale(0.98);
		}

		.option::after {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			opacity: 0;
			transition: opacity 0.3s;
		}

		.option:hover::after {
			opacity: 1;
		}

		/* Voted state styles */
		.option.voted {
			position: relative;
			transform: translateY(-8px) scale(1.05) !important;
			box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4), 0 0 0 4px rgba(255, 255, 255, 0.8) !important;
			border: 3px solid #fff !important;
			opacity: 1 !important;
			animation: voteSuccess 0.6s ease-out;
		}

		.option.voted::after {
			content: '✓';
			position: absolute;
			top: 10px;
			right: 10px;
			background: rgba(255, 255, 255, 0.9);
			color: #28a745;
			width: 30px;
			height: 30px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: bold;
			font-size: 16px;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
			animation: checkmarkAppear 0.3s ease-out 0.2s both;
		}

		.option.voted .voted-label {
			position: absolute;
			bottom: 8px;
			left: 50%;
			transform: translateX(-50%);
			background: rgba(255, 255, 255, 0.95);
			color: #28a745;
			padding: 4px 12px;
			border-radius: 12px;
			font-size: 0.8em;
			font-weight: bold;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
			animation: labelSlideUp 0.4s ease-out 0.3s both;
		}

		.option.not-voted {
			opacity: 0.3 !important;
			transform: scale(0.95) !important;
			filter: grayscale(0.7) !important;
		}

		@keyframes voteSuccess {
			0% {
				transform: translateY(-8px) scale(1.05);
			}
			50% {
				transform: translateY(-12px) scale(1.08);
			}
			100% {
				transform: translateY(-8px) scale(1.05);
			}
		}

		@keyframes checkmarkAppear {
			0% {
				opacity: 0;
				transform: scale(0);
			}
			50% {
				transform: scale(1.2);
			}
			100% {
				opacity: 1;
				transform: scale(1);
			}
		}

		@keyframes labelSlideUp {
			0% {
				opacity: 0;
				transform: translateX(-50%) translateY(10px);
			}
			100% {
				opacity: 1;
				transform: translateX(-50%) translateY(0);
			}
		}

		.option[style*="cursor: not-allowed"]:hover {
			transform: none;
		}

		.option::before {
			content: "X";
			font-weight: bold;
			font-size: 1.5em;
		}

		.option p {
			display: block;
			font-size: 1.1em;
			font-weight: 600;
			line-height: 1.2;
			text-align: center;
			margin: 0;
		}

		.option_a {
			background: linear-gradient(135deg, #e63946, #dc3545);
		}

		.option_a::before {
			content: "A";
			background: rgba(255, 255, 255, 0.25);
			border-radius: 50%;
			width: 1.5em;
			height: 1.5em;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-bottom: 0.5em;
			font-weight: bold;
		}

		.option_b {
			background: linear-gradient(135deg, #007bff, #0056b3);
		}

		.option_b::before {
			content: "B";
			background: rgba(255, 255, 255, 0.25);
			border-radius: 50%;
			width: 1.5em;
			height: 1.5em;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-bottom: 0.5em;
			font-weight: bold;
		}

		.option_c {
			background: linear-gradient(135deg, #ffc107, #e0a800);
		}

		.option_c::before {
			content: "C";
			background: rgba(255, 255, 255, 0.25);
			border-radius: 50%;
			width: 1.5em;
			height: 1.5em;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-bottom: 0.5em;
			font-weight: bold;
		}

		.option_d {
			background: linear-gradient(135deg, #28a745, #20c997);
		}

		.option_d::before {
			content: "D";
			background: rgba(255, 255, 255, 0.25);
			border-radius: 50%;
			width: 1.5em;
			height: 1.5em;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-bottom: 0.5em;
			font-weight: bold;
		}

		#scoreboard {
			flex: 1;
		}

		.status_icon {
			font-size: 4em;
			flex: 2;
			display: flex;
			align-items: center;
			justify-content: center;
			background: linear-gradient(135deg, #e74c3c, #c0392b);
			color: white;
			margin: 1em 0;
			border-radius: 1em;
			box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
			animation: statusAppear 0.8s ease-out;
			position: relative;
			overflow: hidden;
		}

		.status_icon::before {
			content: '';
			position: absolute;
			top: -50%;
			left: -50%;
			width: 200%;
			height: 200%;
			background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
			animation: shimmer 2s ease-in-out infinite;
		}

		@keyframes shimmer {
			from { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
			to { transform: translateX(100%) translateY(100%) rotate(45deg); }
		}

		@keyframes statusAppear {
			from {
				transform: scale(0.8);
				opacity: 0;
			}
			to {
				transform: scale(1);
				opacity: 1;
			}
		}

		.status_icon.success {
			background: linear-gradient(135deg, #27ae60, #2ecc71);
			box-shadow: 0 8px 25px rgba(39, 174, 96, 0.4);
		}

		.status_icon div,
		.status_icon.success .fail {
			display: none;
		}

		.status_icon.success .ok,
		.status_icon.fail .fail {
			display: block;
		}

		.debug {
			padding: 0.5em;
			display: flex;
			gap: 1em;
			background: black;
			color: white;
			overflow-x: scroll;
			font-size: 0.8em;
			align-items: center;
			flex-shrink: 0;
			min-height: 40px;
		}

		#messageBox {
			position: fixed;
			top: 1em;
			left: 50%;
			transform: translateX(-50%);
			display: flex;
			gap: 0.25em;
			flex-direction: column;
			pointer-events: none;
			z-index: 1000;
		}

		#messageBox div {
			font-size: 1.2em;
			padding: 0.75em 1.5em;
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(10px);
			color: black;
			border-radius: 2em;
			text-align: center;
			animation: slideIn 0.3s ease-out;
			box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
			border: 1px solid rgba(255, 255, 255, 0.3);
			font-weight: 600;
		}

		@keyframes slideIn {
			from {
				transform: translateY(-20px);
				opacity: 0;
			}
			to {
				transform: translateY(0);
				opacity: 1;
			}
		}

		#messageBox div.error {
			background: red;
			color: white;
		}

		#messageBox div.info {
			background: white;
			color: black;
		}

		#messageBox div.success {
			background: green;
			color: white;
		}

		#messageBox div.warning {
			background: orange;
			color: white;
		}

	</style>
</head>

<body>

	<div class="page visible" id="loading">
		<div class="vertical_center">
			<div class="spinner" style="margin: 0 auto;"></div>
		</div>
	</div>
	
	<div class="page" id="game">
		<div class="vertical_space">
			<div id="header">
				<h1 id="gameCode">#kod</h1>
				<div class="header-right">
					<span class="badge status" id="gameStatus">Hráč</span>
					<button id="leaveGameBtn" class="leave-btn">Opustiť hru</button>
				</div>
			</div>
			
			<div class="content-wrapper visible" id="playground">
				<p class="question" id="questionText">
					Čakám na otázku...
				</p>
				<div class="options_container">
					<div id="timer" class="waiting">
						<span class="timer-text">-</span>
						<div class="spinner"></div>
					</div>
					<div id="options">
						<div class="option option_a">
							<p>-</p>
						</div>
						<div class="option option_b">
							<p>-</p>
						</div>
						<div class="option option_c">
							<p>-</p>
						</div>
						<div class="option option_d">
							<p>-</p>
						</div>
					</div>
				</div>
			</div>
			
			<div class="content-wrapper" id="result">
				<p class="question" id="questionText2">
					Správna odpoveď
				</p>
				<div>
					<span style="font-size: 0.6em;">Správna odpoveď:</span>
					<p class="answer" id="answerText">
						-
					</p>
				</div>

				<div class="status_icon fail" id="statusIcon">
					<div class="ok">👍</div>
					<div class="fail">👎</div>
				</div>
				<p class="player_time" id="playerTime">
					-
				</p>
				<p class="player_position" id="playerPosition">
					-
				</p>
			</div>
			
			<div class="debug" id="debug">
				<div class="dbox">
					<span>Latency: </span><span id="latencyDisplay">0ms</span>
				</div>
			</div>
		</div>
	</div>
	
	<div id="messageBox"></div>
</body>
<script src="/socket.io/socket.io.js"></script>
<script type="module" src="/shared/connectionStatus.js"></script>
<script type="module" src="/game.js"></script>

</html>